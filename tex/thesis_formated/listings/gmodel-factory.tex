\begin{lstlisting}[language=Java, caption={Parts of \code{XMIGModelFactory}}, label={lst:gmodel-factory}]
@Override
protected void fillRootElement(GModelRoot newRoot) {
    EGraph instanceNodes = modelState.getInstanceGraph();

    newRoot.getChildren().addAll(instanceNodes.stream()
            .map(eObject -> (DynamicEObjectImpl) eObject) //
            .map(this::createNode)//
            .toList());

    ...
}

public GNode createNode(DynamicEObjectImpl eObject) {
    String type = DefaultTypes.NODE;
    if(eObject.eContainer() == null) {
        type = HenshinTypes.XMI_ROOT_NODE;
    }

    GNodeBuilder b = new GNodeBuilder(type) //
            .id(UUIDAdapter.getOrAssignId(eObject)) //
            .layout(GConstants.Layout.VBOX) //
            .addCssClass(HenshinCss.XMI_NODE) //
            .addArguments(GArguments.cornerRadius(3))
            .add(buildHeader(eObject));
    if(!eObject.eClass().getEAllAttributes().isEmpty()) {
        b.add(createAttributesCompartment(eObject.eClass().getEAllAttributes(), eObject));
    }
    applyShapeData(eObject,b);
    return b.build();
}

private GLabel buildHeader(EObject eObject) {
    return new GLabelBuilder(DefaultTypes.LABEL) //
            .id(UUIDAdapter.toLabelId(eObject))
            .addCssClass(HenshinCss.XMI_LABEL)
            .text(eObject.eClass().getName()) //
            .build();
}

...
\end{lstlisting}